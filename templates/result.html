<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{.TestName}} - Result</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      .question-card { border-left: 5px solid #eee; margin-bottom: 16px; }
      .answer-correct { color: #198754; font-weight: bold; }
      .answer-wrong { color: #dc3545; font-weight: bold; }
      .correct-label { background: #198754; color: #fff; padding: 2px 10px; border-radius: 8px; margin-left: 8px;}
      .wrong-label { background: #dc3545; color: #fff; padding: 2px 10px; border-radius: 8px; margin-left: 8px;}
    </style>
</head>
<body class="bg-light">
  <div class="container py-5">
    <div class="row mb-4">
      <div class="col-md-8 mx-auto text-center">
        <h1 class="display-5 mb-3">{{.TestName}} <small class="text-muted">Result</small></h1>
        <div class="my-4">
          <span class="fs-4">Score: <span class="fw-bold">{{printf "%.2f" .Score}}%</span></span>
        </div>
        <div class="my-2">
          <span class="badge bg-secondary">
            Minimum passing: <b>{{printf "%.2f" .PassingPercent}}%</b>
          </span>
        </div>
        <div class="mb-3">
          <span class="badge {{if .Passed}}bg-success{{else}}bg-danger{{end}} fs-5 py-2 px-4">
            {{if .Passed}}Passed!{{else}}Failed{{end}}
          </span>
        </div>
        <p>
          <span class="me-3">Total questions: <b>{{.Total}}</b></span>
          <span>Correct: <b>{{.Correct}}</b></span>
        </p>
        <a href="/pdf" class="btn btn-outline-secondary btn-lg me-2">Download PDF</a>
        <a href="/" class="btn btn-outline-primary btn-lg">Try Again</a>
      </div>
    </div>

    <hr class="mb-4">

    <div class="row">
      <div class="col-md-10 mx-auto">
        <h3 class="mb-3">Question Review</h3>
        {{range $idx, $res := .Results}}
        <div class="card question-card {{if $res.IsCorrect}}border-success{{else}}border-danger{{end}}">
          <div class="card-body">
            <h5 class="card-title">
              Question {{add1 $idx}}
              {{if $res.IsCorrect}}
                <span class="correct-label">Correct</span>
              {{else}}
                <span class="wrong-label">Incorrect</span>
              {{end}}
            </h5>
            <p class="mb-2"><b>{{$res.Question}}</b></p>
            <ul>
              {{if or (eq $res.Type "True") (eq $res.Type "False")}}
                <li>
                  <span>Your answer: </span>
                  {{if $res.UserAnswer}}
                    <span class="{{if $res.IsCorrect}}answer-correct{{else}}answer-wrong{{end}}">
                      {{$res.UserAnswer | index 0}}
                    </span>
                  {{else}}
                    <span class="answer-wrong">No answer</span>
                  {{end}}
                </li>
                <li>
                  <span>Correct answer: </span>
                  <span class="answer-correct">{{$res.CorrectTF}}</span>
                </li>
              {{else}}
                <li>
                  <span>Your answer(s): </span>
                  {{if $res.UserAnswer}}
                    {{range $i, $ans := $res.UserAnswer}}
                      <span class="{{if $res.IsCorrect}}answer-correct{{else}}answer-wrong{{end}}">
                        {{$ans}}
                      </span>{{if lt (add1 $i) (len $res.UserAnswer)}}, {{end}}
                    {{end}}
                  {{else}}
                    <span class="answer-wrong">No answer</span>
                  {{end}}
                </li>
                <li>
                  <span>Correct answer(s): </span>
                  {{range $j, $corr := $res.CorrectAnswer}}
                    <span class="answer-correct">{{$corr}}</span>{{if lt (add1 $j) (len $res.CorrectAnswer)}}, {{end}}
                  {{end}}
                </li>
              {{end}}
            </ul>
            <div class="alert alert-info my-2">
              <strong>Explanation:</strong> {{$res.Explanation}}
            </div>
          </div>
        </div>
        {{end}}
      </div>
    </div>
    <div class="footer">
      <hr>
      <p>Generated by <b>RunExam</b> &ndash; <a href="https://github.com/fpinna/runexam">https://github.com/fpinna/runexam</a></p>
    </div>
  </div>
</body>
</html>
